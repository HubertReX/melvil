{% extends "base.html" %}
{% block head %}
    <link rel="stylesheet" type="text/css" href="/static/css/item_description.css">
{% endblock %}
{% block title %} {{ item.type }} description {% endblock %}
{% block content %}
    {% from "macros.html" import table_row, copy_info_row with context %}
    <div class="cover-container d-flex h-80 p-3 mx-auto flex-column">
        <main role="main" class="inner cover">
            <div class="container my_container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="wrap">
                            <p class="table-title">DESCRIPTION</p>
                            <table>
                                {{ table_row('Title', item.title) }}

                                {% if item.type == 'magazine' %}
                                    {{ table_row('Year', item.year) }}
                                    {{ table_row('Issue', item.issue) }}
                                {% elif item.type == 'book' %}
                                    {{ table_row('Original Title', item.original_title) }}
                                    {{ table_row('Authors', authors_list) }}
                                    {{ table_row('ISBN', item.isbn) }}
                                    {{ table_row('Publication date', item.pub_date) }}
                                    {{ table_row('Publisher', item.publisher) }}
                                {% else %}
                                    <p> There occurred some problems with loading library item. </p>
                                {% endif %}

                                {{ table_row('Language', item.language) }}
                                {{ table_row('Tags', tags_list) }}

                                <tr data-toggle="collapse" data-target="#collapseDescription">
                                    <th>
                                        Description <i class="fa fa-caret-down"></i>
                                    </th>
                                </tr>

                            </table>

                            <div id="collapseDescription" class="collapse" aria-labelledby="headingOne"
                                 data-parent="#accordion">
                                {{ item.description }}
                            </div>
                            {% if admin %}
                                <div>
                                    <a type="button" class="btn btn-primary btn-sm"
                                       href="#">Edit {{ item.type|capitalize }}</a>
                                    <a type="button" class="btn btn-danger btn-sm"
                                       href="#">Delete {{ item.type|capitalize }}</a>
                                </div>
                            {% endif %}
                            {% if item.copies %}
                                <table>
                                    COPIES of {{ item.type }}
                                    <tr>
                                        <th>#</th>
                                        <th>Asset Code</th>
                                        <th>Has CD?</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                    {% for copy in item.copies %}
                                        <tr>
                                            {{ copy_info_row(copy, loop.index) }}
                                            <td><a type="button" class="btn btn-success btn-sm"
                                                   href="#">Borrow</a></td>

                                            {% if admin %}
                                                <td><a type="button" class="btn btn-primary btn-sm"
                                                       href="#">Edit</a></td>
                                                <td><a type="button" class="btn btn-danger btn-sm"
                                                       href="#">Delete</a></td>
                                            {% endif %}

                                        </tr>
                                    {% endfor %}

                                </table>
                            {% else %}
                                <p>No Copies - nothing to borrow.</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

{% endblock %}